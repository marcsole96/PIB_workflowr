---
title: "Contract"
author: "marcsole96"
date: "2021-11-02"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

# Setup
```{r echo=TRUE}
#setwd("../PIB_workflowr/data")
getwd()
```

```{r include=FALSE}
library(tidyverse)
library(ggplot2)
library(ggfortify)
library(Rtsne)
library(reshape2)
library(ggpubr)
library(plotly)
theme_set(theme_minimal())
```

# Opening the data workspace
```{r echo=TRUE}
load("wrangling.RData")
```

# Data analysis
## Visualizations

### PCA
```{r}
labels<-contract$labels

data <- contract %>%
  select(-labels)

data<-as.matrix(data)
rownames(data) <- NULL

pr.out <- prcomp(data,scale=FALSE)

dat_3d <- pr.out$x[,1:3] %>% as_tibble() %>% mutate(square = contract$labels)

fig <- plot_ly(dat_3d, x = ~PC1, y = ~PC2, z = ~PC3, 
               color = ~square,colors=c('#8dc5f0','#43abf9','#0092ff','#cef37b','#a6d045','#7caa16','#f8bc7d','#e0892e','#ff8200'), size = I(100))
fig <- fig %>% add_markers()
fig <- fig %>% layout(scene = list(xaxis = list(title = 'PC1'),
                                   yaxis = list(title = 'PC2'),
                                   zaxis = list(title = 'PC3')))

fig
```



## Models

